n = int(input())g = [[] for _ in range(n+1)]c = [0]for i in range(1, n+1):    p, ci = map(int, input().split())    g[p].append(i)    c.append(ci)b = True def dfs(i):    global b    l = []    for j in g[i]:        l.extend(dfs(j))     if c[i]>len(l):        b = False    l.insert(c[i], i)    return l l = dfs(g[0][0])#print(l)if b:    ans = [0]*(n)    for i in range(0,n):        ans[l[i]-1]=i+1     print('YES')    print(*ans)else:    print('NO')
