import java.util.ArrayList;import java.util.Scanner;  public class Friendsornot { 	/**	 * @param args	 */	public static void main(String[] args) {		// TODO Auto-generated method stub 		Scanner input = new Scanner(System.in);	  int n = input.nextInt();	  String[][] s = new String[n][2];	  int[] t = new int[n];	  int d = input.nextInt();	  for(int i=0;i<n;i++){		  s[i][0] = input.next();		  s[i][1] = input.next();		  t[i] = input.nextInt();		  	  }	 // HashMap<String,String> map = new HashMap<String,String>();	  	 boolean[] condition = new boolean[n];	 ArrayList<String> list1 = new ArrayList<String>();	 ArrayList<String> list2 = new ArrayList<String>();	  for(int i=0; i<n;i++){		  if(condition[i])continue;		  boolean flag= false;		  for(int j=i+1; j<n;j++){			  if(s[i][0].equals(s[j][1]) && s[j][0].equals(s[i][1]) && (t[j]-t[i]<=d) && (t[j]-t[i]>0) ){				  list1.add(s[i][0]);				  list2.add(s[i][1]);			    	  condition[j] = true; 			       flag = true;			    	  break;			  }		  }		  if(flag){		  for(int j=i+1; j<n;j++){			  if(s[i][0].equals(s[j][0]) && s[i][1].equals(s[j][1]))		     condition[j] = true;		     if(s[i][0].equals(s[j][1]) && s[j][0].equals(s[i][1])){		    	 condition[j] =  true;		     }		  }		  }	  }	  System.out.println(list1.size());	  for(int i=0;i<list1.size();i++){		  System.out.println(list1.get(i)+" "+list2.get(i));				  	  }	} }
