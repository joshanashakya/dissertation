import java.util.*; public class Main {    public static void main(String[] args) {        Scanner scanner = new Scanner(System.in);        int n = scanner.nextInt();        int d = scanner.nextInt();        Map<String, List<Integer>> messagesMap = new HashMap<>();        Map<String, String> invertedParticipantsMap = new HashMap<>();        Set<String> friends = new HashSet<>();        for (int i = 0; i < n; i++) {            String a = scanner.next();            String b = scanner.next();            int t = scanner.nextInt();            messagesMap.putIfAbsent(a + " " + b, new ArrayList<>());            messagesMap.get(a + " " + b).add(t);            invertedParticipantsMap.put(b + " " + a, a + " " + b);            if (i > 0 && messagesMap.containsKey(invertedParticipantsMap.get(a + " " + b))) {                for (Integer previousT : messagesMap.get(invertedParticipantsMap.get(a + " " + b))) {                    if (t - previousT <= d && t - previousT > 0) {                        if (!friends.contains(a + " " + b) && !friends.contains(b + " " + a)) {                            friends.add(a + " " + b);                        }                        break;                    }                }            }        }        System.out.println(friends.size());        friends.forEach(f -> System.out.println(f));    }} 
