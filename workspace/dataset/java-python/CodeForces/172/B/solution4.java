import java.util.*;import java.io.*;import java.math.*;public class Solution{        public static void main(String[] args)throws IOException{        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));        StringTokenizer st = new StringTokenizer(br.readLine());                //PrintWriter out = new PrintWriter(System.out);                //n = Integer.parseInt(st.nextToken());                int a = Integer.parseInt(st.nextToken());        int b = Integer.parseInt(st.nextToken());        int m = Integer.parseInt(st.nextToken());        int[] r = new int[1000000];                r[0] = Integer.parseInt(st.nextToken());                for(int i=1;i<1000000;i++){            r[i] = a*r[i-1] + b;            r[i] %= m;        }                int[] place = new int[m];        for(int i=0;i<1000000-1;i++){            place[r[i]] = i;        }                int rep = 1000000-1 - place[r[1000000-1]];        System.out.println(rep);                        //out.flush();    }    }
