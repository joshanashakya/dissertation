 import java.io.*;import java.util.*;public class B172 {    public static void main(String args[])throws IOException    {        Scanner sc=new Scanner(System.in);        int a =sc.nextInt();        int b=sc.nextInt();        int m=sc.nextInt();        int r0=sc.nextInt();        HashMap<Integer,Integer> map=new HashMap<>();                int x=0;        while(true)        {            r0=(a*r0 + b)%m;            if(map.containsKey(r0))                break;            map.put(r0,x);            x++;        }        System.out.println(map.size()-map.get(r0));    } }
