import sys def answer(s):    c1 = s.count('1')    c2 = s.count('2')    c3 = s.count('3')    if c1 == 0 or c2 == 0 or c3 == 0:        return 0    #at least 1 of each.    cnt = [0] * 4 #1-based to count 1s, 2s, and 3s.    lptr = 0    rptr = 2     min_len = len(s)    for i in range(3):        cnt[int(s[i])] += 1    new_rptr = False    while min_len > 3 and rptr < len(s):        if new_rptr:            cnt[int(s[rptr])] += 1            new_rptr = False        if cnt[1] == 0 or cnt[2] == 0 or cnt[3] == 0:            rptr += 1            new_rptr = True        else: #substring contains 1, 2, 3            min_len = min(min_len, rptr+1 - lptr)            cnt[int(s[lptr])] -= 1            lptr += 1             return min_len    def main():    t = int(input())    while t:        s = sys.stdin.readline().rstrip()        print(answer(s))        t -= 1    returnmain()
