import java.util.*; public class Main {    public static void main(String[] args) {        Scanner sc = new Scanner(System.in);        int t = sc.nextInt();        while(t-->0) {            int n = sc.nextInt(), m = sc.nextInt(), x = sc.nextInt(), y = sc.nextInt();            int best = Math.min(2 * x, y), ans = 0;            char [][]ar = new char[n][m];             for(int i=0; i<n; i++) {                String s = sc.next();                for(int j=0; j<s.length(); j++) ar[i][j] = s.charAt(j);            }             for(int i=0; i<n; i++) {                for(int j=0; j<m; j++) {                    if(ar[i][j] == '.') {                        if(j == m-1) {                            ans += x;                            ar[i][j] = '*';                        }                        else  {                            if(ar[i][j+1]=='.') {                                ans += best;                                ar[i][j] = '*';                                ar[i][j+1]= '*';                            }                            else {                                ans += x;                                ar[i][j] = '*';                            }                        }                    }                }            }            System.out.println(ans);        }    }}
