//package com.problem2.cotest88; import java.io.BufferedReader;import java.io.IOException;import java.io.InputStreamReader;import java.util.Scanner; public class Contest88Problem2 { 	public static void main(String[] args) throws IOException {		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));		int T = Integer.parseInt(br.readLine());		while (T-- > 0) {			String str[] = br.readLine().split(" ");			int n = Integer.parseInt(str[0]);			int m = Integer.parseInt(str[1]);			int x = Integer.parseInt(str[2]);			int y = Integer.parseInt(str[3]); 			int cost = 0;			for (int i = 0; i < n; i++) {				String temp = br.readLine(); 				int dotCount = 0;				for (int k = 0; k < temp.length(); k++) {					if (temp.charAt(k) == '.') {						dotCount++;					}					if ((temp.charAt(k) == '*' || k == temp.length() - 1) && dotCount > 0) {						if (2 * x > y) {							if (dotCount % 2 == 0) {								cost = cost + (y * (dotCount / 2));							} else {								dotCount--;								cost = cost + x;								cost = cost + (y * (dotCount / 2));							}						} else {							cost = cost + (x * dotCount);						}						dotCount = 0;					}				} 			} 			System.out.println(cost); 		}	} }
