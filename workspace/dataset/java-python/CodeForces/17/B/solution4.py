def find(arr,a):	if arr[a]==a:		return a	arr[a]=find(arr,arr[a])	return arr[a]n=int(input())x=list(map(int,input().split()))arr=[i for i in range(n+1)]m=int(input())l=[]for _ in range(m):	l.append(list(map(int,input().split())))l.sort(key=lambda k:k[2])val=nans=0for i in range(m):	x=find(arr,l[i][0])	y=find(arr,l[i][1])	if x!=y and y==l[i][1]:		val-=1		arr[y]=x		ans+=l[i][2]if val!=1:	print(-1)else:	print(ans)
