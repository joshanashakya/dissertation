n, m = map(int, input().split())p = [list(input()) for _ in range(n)]x, y = 0, 0for i in range(n):    for j in range(m):        if p[i][j] == 'S':            x = i            y = j st = input()command = ('D', 'L', 'U', 'R')d_x = {    'D': lambda x: x,    'L': lambda x: x - 1,    'R': lambda x: x + 1,    'U': lambda x: x,} d_y = {    'D': lambda y: y + 1,    'L': lambda y: y,    'R': lambda y: y,    'U': lambda y: y - 1,}count = 0for el1 in command:  # 0    for el2 in command:  # 1        for el3 in command:  # 2            for el4 in command:  # 3                if len({el1, el2, el3, el4}) == 4:                    command_d = {                        '0': el1,                        '1': el2,                        '2': el3,                        '3': el4,                    }                    p1, p2 = x, y                    for el in st:                        p1 = d_x[command_d[el]](p1)                        p2 = d_y[command_d[el]](p2)                        if not(0 <= p1 < n) or not(0 <= p2 < m) or p[p1][p2] == '#':                            break                        if p[p1][p2] == 'E':                            count += 1                            breakprint(count)
