def Diff(li1, li2):    li_dif = [i for i in li1 + li2 if i not in li1 or i not in li2]    return li_difn,m=list(map(int,input().split()))g=[]for i in range(n):    g.append(input())p=input()x,y,f=0,0,0for i in range(n):    for j in range(m):        if g[i][j]=='S':            x,y=i,j            f=1            break    if f:        breakans=0d={}l=['l','r','u','d']for i in l:    d['0']=i    l1=Diff(l,[i])    for j in l1:        d['1']=j        l2=Diff(l,[i,j])        for k in l2:            d['2']=k            l3=Diff(l,[i,j,k])            for t in l3:                d['3']=t                f=0                a,b=x,y                for pt in p:                    if d[pt]=='l':                        a=a-1                    elif d[pt]=='r':                        a=a+1                    elif d[pt]=='u':                        b=b+1                    elif d[pt]=='d':                        b=b-1                    if (a<0) or (a>=n) or (b<0) or (b>=m):                        break                    elif g[a][b]=='#':                        break                    elif g[a][b]=='E':                        f=1                        break                if f:                    ans=ans+1print(ans)
