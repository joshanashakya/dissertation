import java.io.BufferedReader;import java.io.InputStreamReader;import java.util.StringTokenizer;Â public class cf908b {//	27	29//	29	30//	30	41//	41	52	public static void main(String[] args) throws Exception{		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));		StringTokenizer st = new StringTokenizer(br.readLine());		int n = Integer.parseInt(st.nextToken());		int m = Integer.parseInt(st.nextToken());		boolean[][] maze = new boolean[n][m];		int si=0, sj=0, ei=0, ej=0;		for (int i=0;i<n;i++) { char[] row = br.readLine().toCharArray();			for(int j=0;j<m;j++) {				char c = row[j];				if (c=='#') {maze[i][j] = true;}				else if (c=='S') {si = i; sj=j;}				else if (c=='E') {ei = i; ej=j;}			}		}		char[] inst = br.readLine().toCharArray();		int ans = 0;		for (int left=0;left<4;left++) {			for (int up=0;up<4;up++) {				if (up==left) continue;				for (int right=0;right<4; right++) {					if (right==up || right == left) continue;					for (int down=0;down<4;down++) {						if (down==right || down == up || down == left) continue;							int[] dx = new int[4];							int[] dy = new int[4];							dx[left]=-1;// dy[left]=0;							dx[right]=1; //dy[right]=0;							 dy[up]=1; //dx[up]=0;							dy[down]=-1; //dx[down]=0;							int curx = si; int cury= sj;							boolean flag=true;							for (int i=0;i<inst.length && flag;i++) {								if (curx<0 || curx >= n || cury<0 || cury>=m) { flag = false; break;}								if (curx==ei && cury== ej) break;								if (maze[curx][cury]) {flag = false; break;}//								System.out.println(i);//								System.out.println(dx.length);//								System.out.println(inst[i]);//								System.out.println(inst.length);//								System.out.println(dy[inst[i]-'0']);								curx += dx[inst[i]-'0'];								cury += dy[inst[i]-'0'];							}							if(flag && curx==ei && cury==ej) {								ans++;//								System.out.printf("L=%d U=%d R=%d D=%d\n", left,up,right,down);							}					}				}			}		}		System.out.println(ans);	}}
