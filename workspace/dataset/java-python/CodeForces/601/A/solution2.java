import java.util.*;public class tw{	public static void main(String[] args) {		Scanner sc = new Scanner(System.in);		int n = sc.nextInt();		int m = sc.nextInt();		int[][] V = new int[n+1][n+1];		for(int i=0;i<m;i++){			int a = sc.nextInt();			int b = sc.nextInt();			V[a][b]=1;			V[b][a]=1;		}		Queue<Integer> q = new LinkedList<>();		q.add(1);	    int [] d = new int[n+1];		while(!q.isEmpty()){		     int vertex = q.poll();		     for(int i=2;i<=n;i++){		     	if(d[i]==0 && V[vertex][i]!=V[1][n]){		     		d[i]=d[vertex]+1;		     		q.add(i);		     	}		     }		}		if(d[n]==0){			System.out.println(-1);		}		else{			System.out.println(d[n]);		}	}}
