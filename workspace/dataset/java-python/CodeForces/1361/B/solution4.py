from math import log2Â def main():        t=int(input())    allAns=[]    MOD=10**9+7    for _ in range(t):        n,p=readIntArr()        a=readIntArr()                if p==1: #put half in each group            if n%2==1:                ans=1            else:                ans=0        else:            a.sort(reverse=True)            totalMOD=0            totalExact=0 #store exact total//p**a[i] for current i. total must be a multiple of p**a[i]            prevPow=a[0]            i=0            while i<n:                x=a[i]                #if totalExact//p**x>n, then just subtract all the remaining elements since totalExact can't reach 0                if totalExact!=0 and log2(totalExact)+(prevPow-x)*log2(p)>log2(n): #using log or else number may get too big                    while i<n:                        x=a[i]                        totalMOD-=pow(p,x,MOD)                        totalMOD=(totalMOD+MOD)%MOD                        i+=1                else:                    if totalExact>0:                        totalExact*=(p**(prevPow-x))                    prevPow=x                    if totalExact==0: #add                        totalMOD+=pow(p,x,MOD)    #                    totalMOD+=mod_pow(p,x)                        totalMOD%=MOD                        totalExact+=1                    else:                        totalMOD-=pow(p,x,MOD)    #                    totalMOD-=mod_pow(p,x)                        totalMOD=(totalMOD+MOD)%MOD                        totalExact-=1    #                print('x:{} total:{}'.format(x,total))                i+=1            ans=totalMOD        allAns.append(ans)    multiLineArrayPrint(allAns)        return import sysinput=sys.stdin.buffer.readline #FOR READING PURE INTEGER INPUTS (space separation ok)#import sys#input=lambda: sys.stdin.readline().rstrip("\r\n") #FOR READING STRING/TEXT INPUTS. def oneLineArrayPrint(arr):    print(' '.join([str(x) for x in arr]))def multiLineArrayPrint(arr):    print('\n'.join([str(x) for x in arr]))def multiLineArrayOfArraysPrint(arr):    print('\n'.join([' '.join([str(x) for x in y]) for y in arr])) def readIntArr():    return [int(x) for x in input().split()]  main()
