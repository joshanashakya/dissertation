import java.lang.*;import java.util.*;import java.util.stream.Collectors;import java.io.*; public class Bouncing  { 	public static void main(String[] args) throws IOException {		Scanner sc = new Scanner(System.in);		int n = sc.nextInt();		int i=0,j=0,totfw=1;		int sum=0;		List<Integer> crdsfw = new ArrayList<Integer>();		List<Integer> crds0 = new ArrayList<Integer>();		for(int k=0;k<n;k++) {			int point = sc.nextInt();			int fw = sc.nextInt();			if(fw==0) {				crds0.add(point);			}			else			{				crdsfw.add(point);			}			totfw+=fw;		}		Collections.sort(crds0,Collections.reverseOrder());				for(int pp : crdsfw)sum += pp;				totfw -= crdsfw.size();		//System.out.println(totfw);		if(totfw >= crds0.size()) {			for(int pp : crds0)sum+=pp;		}		else		{			if(totfw==0 && crds0.size()>0)sum += crds0.get(0);			else {				for(i=0;i<totfw;i++)sum += crds0.get(i);			}		}				System.out.println(sum);		}}
