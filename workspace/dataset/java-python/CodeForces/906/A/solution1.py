n = int(input())susp = set([chr(ord('a') + i) for i in range(ord('z') - ord('a') + 1)])ok = set()q = 0ans = 0for i in range(n):	act, word = input().split()	if act == '!':		susp = susp & set(list(word)) - ok		ans += q	elif act == '.':		ok |= set(list(word))		susp -= ok	elif act == '?':		ok.add(word)		susp.discard(word)		ans += q#	print(susp, ok)	if len(susp) == 1:		q = 1print(max(ans - 1, 0))
