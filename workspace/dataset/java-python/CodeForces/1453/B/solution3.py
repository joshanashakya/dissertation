def main():    from sys import \
    stdin  # from math import gcd    from random import randint, choice, shuffle    from functools import lru_cache    input = stdin.readline        for _ in range(int(input())):        n = int(input())        *a, = map(int, input().split())        d = [0] * n        s = 0        for i in range(n):            if i:                d[i] = abs(a[i] - a[i - 1])                s += d[i]        ans = 10**20        for i in range(n):            if not i:                ans = min(ans, s - d[1])            elif i != n - 1:                ans = min(ans, s - d[i] - d[i + 1] + abs(a[i + 1] - a[i - 1]))            else:                ans = min(ans, s - d[i])        print(ans)main()Â 
