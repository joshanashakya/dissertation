import randomimport sys def process(n, start, X):    ran       =  [start] + list(set([random.randint(1, n) for _ in range(990)]))    arr       =  [ask(index)[0] for index in ran]    pos, init =  find(ran, arr, X)    ans       = -1        if pos == None:        ans = arr[0]            elif init == X:        ans = init            else:        cur = init        cnt = 0            while cnt <= 999:            cur, pos = ask(pos)                        if cur >= X:                ans = cur                break                            if pos == -1:                break                    cnt+=1                print('! {}'.format(ans))                def find(ran, arr, X):    diff        = float('inf')    pos, init   = None, None        for i, x in zip(ran, arr):        if x <= X and abs(x-X)<diff:            diff = abs(x-X)            pos  = i             init = x                return pos, init    def ask(index):    print('? {}'.format(index))    sys.stdout.flush()            val_, next_ = map(int, input().split())            return val_, next_         n, start, X = map(int, input().split())process(n, start, X)
