import java.util.Scanner; public class srf {    static Scanner sc = new Scanner(System.in);        public static void main (String[] args) {        int n = sc.nextInt(), start = sc.nextInt(), x = sc.nextInt();        Ans argmax= query(start);        // System.out.println("ff");        for (int i = 0;i<998;i++) {            int q = 1 + (int)(Math.random()*(n-1));            Ans res = query(q);            if (res.v > x) continue;            if (res.v>argmax.v){                 argmax = res;            }        }        // System.out.println("first part done");                for (int i = 0;i<950;i++) {            if (argmax.v>=x) {                System.out.println("! " + argmax.v);                return;            } else if (argmax.nxt==-1) {                System.out.println("! -1");                return;            }            argmax = query(argmax.nxt);                   }        System.out.println("! " + argmax.nxt);            }            static Ans query(int val) {        System.out.println("? " + (val));        return new Ans(sc.nextInt(), sc.nextInt());            }        static class Ans {        int v, nxt;        Ans(int v, int nxt) {            this.v = v;            this.nxt = nxt;        }    }    }        
