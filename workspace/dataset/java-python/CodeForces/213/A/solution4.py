n = int(input())c = list(map(int, input().split()))d = dict()d[1] = []d[2] = []d[3] = []for i in range(n):    d[c[i]].append(i)done = set()mas = []k = 0poss = set()for i in range(n):    l = list(map(int, input().split()))    l = l[1:]    mas.append(l)    if len(l) == 0:        k = c[i]        poss.add((k, i))o = 0bigans = 1000000000for a in poss:    k = a[0]    done = set()    done.add(a[1] + 1)    ans = 1    while len(done) != n:        #o += 1        if o == 10:            break        while True:            y = len(done)            for i in d[k]:                if (i + 1) in done:                    continue                flag = True                for j in mas[i]:                    if j not in done:                        flag = False                if flag:                    done.add(i + 1)                    ans += 1            if y == len(done):                break        if len(done) == n:            break        k += 1        ans += 1        if k == 4:            k = 1    bigans = min(bigans, ans)print(bigans)
