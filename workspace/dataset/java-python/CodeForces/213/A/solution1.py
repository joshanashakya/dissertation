f = lambda: [int(q) - 1 for q in input().split()]def g():    for i in p:        if h[i] == k and not v[i]: return i r = range(int(input()))t, h = 1e9, f()u = [set(f()[1:]) for i in r] for k in (0, 1, 2):    p = list(r)    d = -1    v = [q.copy() for q in u]     while p:        i = g()        while i != None:            d += 1            p.remove(i)            for q in v : q.discard(i)            i = g()        k = (k + 1) % 3        d += 1     t = min(d, t) print(t)
