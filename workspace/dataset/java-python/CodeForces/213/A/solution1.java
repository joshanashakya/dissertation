import java.util.*; public class practice {			public static void main(String[] args) {						Scanner scn=new Scanner(System.in);			int n=scn.nextInt(),k,t;			int[] comp=new int[n+1],req=new int[n+1],treq=new int[n+1];			ArrayList<Integer>[] gr=new ArrayList[n+1];			LinkedList<Integer>[] q=new LinkedList[4];			for(int i=0;i<4;i++){				q[i]=new LinkedList();			}			for(int i=0;i<=n;i++){				gr[i]=new ArrayList<>();			}			for(int i=1;i<=n;i++){				comp[i]=scn.nextInt();			}			for(int i=1;i<=n;i++){				k=scn.nextInt();				req[i]=k;				for(int j=1;j<=k;j++){					t=scn.nextInt();					gr[t].add(i);				}			}			int sol=Integer.MAX_VALUE,tsol,x;			for(int c=1;c<=3;c++){				tsol=0;x=c;				for(int i=1;i<=n;i++){					treq[i]=req[i];					if(req[i]==0){						q[comp[i]].add(i);					}				}				while((!q[1].isEmpty())||(!q[2].isEmpty())||(!q[3].isEmpty())){					while(!q[x].isEmpty()){						int cur=q[x].poll();						tsol++;						for(int i=0;i<gr[cur].size();i++){							int v=gr[cur].get(i);							treq[v]--;							if(treq[v]==0){								q[comp[v]].add(v);							}						}											}					if((!q[1].isEmpty())||(!q[2].isEmpty())||(!q[3].isEmpty()))tsol++;					x++;					if(x>3)x=1;				}				sol=Math.min(sol, tsol);											}						System.out.println(sol);		}	} 
