# JOAO MARCELO - 2021# 271Bimport mathfrom bisect import bisect_leftmaxi = 100010n, m = [int(x) for x in input().split()]tag = [0] * maxilines = [0] * ncols = [0] * mprime = [0] * maxi tag[0] = tag[1] = 1count = 0for i in range(2, maxi):    if(not tag[i]):        prime[count] = i        count += 1    j = 0    while(j < count and prime[j] * i < maxi):        tag[i * prime[j]] = 1        if(i % prime[j] == 0):            break        j += 1  matrix = [] prime = prime[0:count]# print(prime)for i in range(n):    col = [int(x) for x in input().split()]    matrix.append(col) for l in range(n):    for c in range(m):        x = matrix[l][c]        if(tag[x]):            t = bisect_left(prime, x)            lines[l] += (prime[t] - x)            cols[c] += (prime[t] - x)  min_col = min(cols)min_line = min(lines)print(min(min_col, min_line))
