import mathn, m = map(int, input().rstrip().split())row = [0] * ncol = [0] * mdef isPrime(x):    if x in [2, 3, 5, 7, 11, 13, 17, 19]:        return True    if x == 1:        return False    for i in range(2,int( math.sqrt(x)) + 2):        if x % i == 0:            return False    return Trueprimes = [0] * 100011for i in range(1, 100011):    if isPrime(i):        primes[i] = 1for i in range(n):    li = list(map(int, input().rstrip().split()))    for j in range(m):        x = li[j]        while primes[x] != 1:            x += 1        row[i] += x - li[j]        col[j] += x - li[j]minm = min(row + col)print(minm)   	   	 	   							 	   	   		
