import sysMAX_SIZE = 100001isprime = [True] * MAX_SIZEprime = []SPF = [None] * (MAX_SIZE)d = dict()def manipulated_seive(N):    isprime[0] = isprime[1] = False    for i in range(2, N):        if isprime[i] == True:            prime.append(i)            d.setdefault(i,1)            SPF[i] = i        j = 0        while (j < len(prime) and i * prime[j] < N and prime[j] <= SPF[i]):            isprime[i * prime[j]] = False            d.setdefault(i * prime[j],0)            SPF[i * prime[j]] = prime[j]            j += 1if __name__ == '__main__':    manipulated_seive(100001)    d.setdefault(1,0)    prev = 100003    for i in range (100000,0,-1):        if d[i]==0:            d[i] = prev        else:            d[i] = i            prev = iÂ     ans = sys.maxsize    n,m = map(int, input().split())    l = []    for i in range (n):        l.append(list(map(int, input().split())))    for i in range (n):        c = 0        for j in range (m):            c+=(d[l[i][j]]-l[i][j])        ans = min(c,ans)    for j in range (m):        c = 0        for i in range (n):            c+=(d[l[i][j]]-l[i][j])        ans = min(c,ans)    print(ans)
