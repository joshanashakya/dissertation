import java.util.ArrayList;import java.util.Scanner; public class PrimeMatrix {     private static ArrayList<Integer> primes;    public static void main(String[] args) {        Boolean[] PrimeGetter = new Boolean[100004];        primes = new ArrayList<>();         for (int i = 2; i < 100004; i++) {            if(PrimeGetter[i] == null) {                for (int j = 2*i; j < 100004; j += i) {                    PrimeGetter[j] = false;                }                 primes.add(i);            }        }         Scanner scanner = new Scanner(System.in);         int n = scanner.nextInt();        int m = scanner.nextInt();         long[] row = new long[n];        long[] col = new long[m];         for (int i = 0; i < n; i++) {            for (int j = 0; j < m; j++) {                int x = scanner.nextInt();                 int diff = primes.get(search(x)) - x;                 row[i] += diff;                col[j] += diff;            }        }         long min = row[0];         for (int i = 1; i < n; i++) min = Math.min(min, row[i]);        for (int i = 0; i < m; i++) min = Math.min(min, col[i]);         System.out.println(min);    }     private static int search (int x) {        int first = 0, last = primes.size() - 1;        int result = -1;         while (first <= last) {            int mid = (first + last)/2;             if(x <= primes.get(mid)) {                result = mid;                last = mid - 1;            } else first = mid + 1;        }         return result;    }}
