import java.io.BufferedReader;import java.io.InputStreamReader;import java.io.IOException;import java.util.StringTokenizer;public class Solution{	public static void main(String[] args){		try(BufferedReader in = new BufferedReader(new InputStreamReader(System.in))){			StringTokenizer s = new StringTokenizer(in.readLine());			int n = Integer.parseInt(s.nextToken());			int m = Integer.parseInt(s.nextToken());			int min_sub = Integer.MAX_VALUE;  //length of minimum subarray			int[] ans = new int[n];			int l=0,r=0;			for(int i=0;i<m;i++){				s = new StringTokenizer(in.readLine());				l = Integer.parseInt(s.nextToken());				r = Integer.parseInt(s.nextToken());				if(r-l < min_sub) min_sub = r-l;			}			int y=0;			for(int i=0;i<n;i++){				ans[i] = y++;				if(y== min_sub+1) y=0;			}			System.out.println(min_sub+1);			for(int i=0;i<n;i++){				System.out.print(ans[i]);				if(i<n-1) System.out.print(" ");			}		}catch(IOException e){					}	}}
