import osimport ioinput = io.BytesIO(os.read(0, os.fstat(0).st_size)).readline n, q = map(int, input().split()) last_2 = [-1] * nunread_count = [0] * ntotal_unread = 0ev = []max_3 = 0 ans = [] for i in range(q):    t, x = map(int, input().split())    x -= 1        if t==1:        ev.append(x)        unread_count[x] += 1        total_unread += 1    elif t==2:        total_unread -= unread_count[x]        unread_count[x] = 0        last_2[x] = len(ev)-1    else:        for j in range(max_3, x+1):            el = ev[j]            if last_2[el] < j:                total_unread -= 1                unread_count[el] -= 1         max_3 = max(max_3, x+1)            ans.append(total_unread)    for a in ans:    print(a)
