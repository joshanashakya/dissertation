import java.util.Scanner; public class Main {	public static void main(String[] args) {		Scanner sc = new Scanner(System.in);		int t = sc.nextInt();		while(t-- > 0) {			int n = sc.nextInt();			int k = sc.nextInt();			char[] ch = sc.next().toCharArray();			boolean f = true;			for(int i=k;i<n;i++) {				if(ch[i]=='?'||ch[i]==ch[i%k]) continue;				else if(ch[i%k]=='?') {					ch[i%k] = ch[i];				}else {					f = false;					break;				}			}			if(!f) {				System.out.println("NO");				continue;			}else {				int s0 = 0,s1 = 0;				for(int i=0;i<k;i++) {					if(ch[i]=='0') s0++;					else if(ch[i]=='1') s1++;				}				if(s0>k/2||s1>k/2) {					System.out.println("NO");				}else {					System.out.println("YES");				}			}		}	}}  	     	    		  			 		       	
