# include<stdio.h>#include<iostream>#include<algorithm>#define N 1000005#define M 70using namespace std;typedef long long ll;ll prime[N + 1];ll a[N + 1], b[N + 1], c[N + 1], cnts[N + 1];int main() {    prime[1] = 1;    for (ll i = 2; i * i <= N; i++) {        if (prime[i] != 0) continue;        for (ll j = i+i; j <= N; j += i) {            prime[j] = i;        }    }     ll t;    cin >> t;    while (t--) {        ll n, q;        cin >> n;        for (ll i = 1; i <= n; i++) scanf("%lld", &a[i]);        cin >> q;         for (ll i = 1; i <= n; i++) {            ll tmp[M + 1] = { 0 };            ll val = a[i], idx = 0, cnt = 0, prev = 1;             while (val != 1) {                if (prime[val] == 0) prime[val] = val;                tmp[++idx] = prime[val];                val /= prime[val];            }            sort(tmp + 1, tmp + idx + 1);            for (ll j = 1; j <= idx + 1; j++) {                if (prev != tmp[j]) {                    if (cnt % 2 == 1) val *= prev;                    prev = tmp[j];                    cnt = 1;                }                else cnt++;            }            c[i] = val;            cnts[val]++;        }        sort(c + 1, c + n + 1);         ll ans1 = cnts[1], ans2 = cnts[1];        for (ll i = 1; i <= n; i++) {            if (ans1 < cnts[c[i]]) ans1 = cnts[c[i]];        }         for (ll i = 1; i <= n; i++) {            if ((cnts[c[i]] % 2) == 0 && (c[i] != 1)) {                cnts[1] += cnts[c[i]];                cnts[c[i]] = 0;            }        }         ans2 = cnts[1];        for (ll i = 1; i <= n; i++) {            if (ans2 < cnts[c[i]]) ans2 = cnts[c[i]];        }         for (ll i = 1; i <= q; i++) {            ll tmp;            scanf("%lld", &tmp);            if (tmp == 0) printf("%lld\n", ans1);            else printf("%lld\n", ans2);        }         for (ll i = 1; i <= n; i++) cnts[c[i]] = 0;        cnts[1] = 0;    }    return 0;}
