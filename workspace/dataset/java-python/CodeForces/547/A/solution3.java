// practice with rainboyimport java.io.*;import java.util.*; public class CF547A extends PrintWriter {	CF547A() { super(System.out, true); }	Scanner sc = new Scanner(System.in);	public static void main(String[] $) {		CF547A o = new CF547A(); o.main(); o.flush();	} 	int[] used;	int i_, m_;	int solve(int h, int a, int x, int y, int m) {		Arrays.fill(used, -1);		i_ = -1;		int i;		for (i = 0; used[h] < 0; h = (int) (((long) x * h + y) % m), i++) {			used[h] = i;			if (h == a && i_ == -1)				i_ = i;		}		if (i_ == -1)			return 0;		if (i_ < used[h])			return 1;		m_ = i - used[h];		return 2;	}	int solve1(int i, int j, int m) {		return i >= j && (i - j) % m == 0 ? i : -1;	}	int d_, x_, y_;	void gcd_(int a, int b) {		if (b == 0) {			d_ = a;			x_ = 1; y_ = 0;		} else {			gcd_(b, a % b);			int tmp = x_ - a / b * y_; x_ = y_; y_ = tmp;		}	}	long solve2(int i, int n, int j, int m) {		if (i < j)			return solve2(j, m, i, n);		// i + x * n == j + y * m		// x * n - y * m = j - i		// x_ * n + y_ * m = d_		gcd_(n, m);		if ((j - i) % d_ != 0)			return -1;		int a = n / d_;		int b = m / d_;		int c = (j - i) / d_;		// x * a - y * b = c		// x_ * a + y_ * b = 1		long x = (long) x_ * c % b;		if (x < 0)			x += b;		return i + x * n;	}	void main() {		int m = sc.nextInt();		int h1 = sc.nextInt();		int a1 = sc.nextInt();		int x1 = sc.nextInt();		int y1 = sc.nextInt();		int h2 = sc.nextInt();		int a2 = sc.nextInt();		int x2 = sc.nextInt();		int y2 = sc.nextInt();		used = new int[m];		int c1 = solve(h1, a1, x1, y1, m);		if (c1 == 0) {			println(-1);			return;		}		int i1 = i_, m1 = m_;		int c2 = solve(h2, a2, x2, y2, m);		if (c2 == 0) {			println(-1);			return;		}		int i2 = i_, m2 = m_;		long ans;		if (c1 == 1 && c2 == 1)			ans = i1 == i2 ? i1 : -1;		else if (c1 == 1 && c2 == 2)			ans = solve1(i1, i2, m2);		else if (c1 == 2 && c2 == 1)			ans = solve1(i2, i1, m1);		else			ans = solve2(i1, m1, i2, m2);		println(ans < 0 ? -1 : ans);	}}
