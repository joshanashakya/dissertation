import java.io.*;import java.lang.*;import java.util.*; /** * @author Sarangdeep Singh <sarangdeep.singh@outlook.com> * @link https://codeforces.com/problemset/problem/295/B */public class GregAndGraph_295B {    private static int n = 0;    private static long[][] graph;     public static void main(String[] args) throws IOException {        BufferedReader sc = new BufferedReader(new InputStreamReader(System.in));        n = Integer.parseInt(sc.readLine());        graph = new long[n][n];        for (int i = 0; i < n; i++) {            String[] line = sc.readLine().split("\\s");            for (int j = 0; j < n; j++) {                graph[i][j] = Integer.parseInt(line[j]);            }        }        int cnt = 0;        long[] ans = new long[n];        String[] downVertices = sc.readLine().split("\\s");        boolean[] vis = new boolean[n];        for (int p = n - 1; p >= 0; p--) {            int down = Integer.parseInt(downVertices[p]) - 1;            vis[down] = true;            for (int u = 0; u < n; u++) {                for (int v = 0; v < n; v++) {                    graph[u][v] = Math.min(graph[u][v], graph[u][down] + graph[down][v]);                }            }              long sum = 0;            for (int i = 0; i < n; i++) {                for (int j = 0; j < n; j++) {                    if (vis[i] && vis[j]) {                        sum += graph[i][j];                    }                }            }            ans[cnt++] = sum;        }         for (int i = n - 1; i >= 0; i--) {            System.out.println(ans[i]);        }    }}
