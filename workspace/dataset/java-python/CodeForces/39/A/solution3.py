import re n = int(input())v = input()f1, f2 = v.count('a++'), v.count('++a')s = []i = 0while i < len(v) - 2:	if v[i] + v[i + 1] + v[i + 2] == '++a':		s.append('b')		i += 3	elif v[i] + v[i + 1] + v[i + 2] == 'a++':		s.append('a')		i += 3	else:		if i == len(v) - 2:			s.extend(v[i:])			i = len(v)		else:			s.append(v[i])			i += 1 a, m = [], []z = 1t = ''for i in s:	if i in ['-', '+']:		if z:			a.append(t)		else:			m.append(t)		t = ''		z = 0 if i == '-' else 1	else:		t += i if t != '':	if z:		a.append(t)	else:		m.append(t) for i in range(len(a)):	t = a[i].split('*')	r = 1	k1 = k2 = 0	for j in t:		if not j.isalpha():			r *= int(j)		elif j == 'a':			k1 += 1		else:			k2 += 1	a[i] = (r, k1, k2) for i in range(len(m)):	t = m[i].split('*')	r = 1	k1 = k2 = 0	for j in t:		if j.isnumeric():			r *= int(j)		elif j == 'a':			k1 += 1		else:			k2 += 1	m[i] = (r, k1, k2) a.sort(key=lambda x: x[0])m.sort(key=lambda x: -x[0]) ans = 0t = n for i in m:	if i[1] + i[2] == 0:		ans += i[0]		continue	z = i[0]	for j in range(i[1]):		z *= t		t += 1	for j in range(i[2]):		t += 1		z *= t	ans += z res = 0for i in a:	if i[1] + i[2] == 0:		res += i[0]		continue	z = i[0]	for j in range(i[1]):		z *= t		t += 1	for j in range(i[2]):		t += 1		z *= t	res += z print(res - ans)
