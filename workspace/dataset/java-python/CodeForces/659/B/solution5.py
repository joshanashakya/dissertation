from operator import itemgetterfrom collections import defaultdictn,m= map(int,input().split())dicta=defaultdict(list)details=[]for i in range(n):    participant = input().split()    participant[1]=int(participant[1])    participant[2]=int(participant[2])    details.append(participant)Â details.sort(key=itemgetter(1,2))for j in range(n):    dicta[details[j][1]].append([details[j][0],details[j][2]])for key in dicta.keys():    valu=len(dicta[key])    if len(dicta[key])!=2 and dicta[key][valu-2][1]==dicta[key][valu-3][1]:        print("?")    else:        print("{} {}".format(dicta[key][valu-1][0],dicta[key][valu-2][0]))
