def main():    N,M = map(int,input().split())    x = {}    for i in range(M):        x[i+1] = []    for j in range(N):        a,b,c = (input().split())        b = int(b)        c = int(c)        x[b] += [(c,a)]    for k in range(M):        y = sorted(x[k+1])[::-1]        if len(y) > 2 and (y[1][0] == y[2][0]):            print("?")        else:            print(y[0][1]+ ' ' + y[1][1])if __name__ == '__main__':    main() 
