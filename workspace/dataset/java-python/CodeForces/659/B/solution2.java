/*package whatever //do not write package name here *///package one;import java.io.BufferedReader;import java.io.IOException;import java.io.InputStreamReader;import java.util.ArrayList;import java.util.Collections;import java.util.Comparator;import java.util.List; public class Solution7 {	public static void main(String[] args) throws NumberFormatException, IOException  {		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));		String[] sa = br.readLine().split(" ");		int n = Integer.parseInt(sa[0]);		int m = Integer.parseInt(sa[1]);		List<Details> list = new ArrayList<Details>();		for(int i=0;i<n;i++)		{			String[] sa1 = br.readLine().split(" ");			Details d = new Details(sa1[0], Integer.parseInt(sa1[1]), Integer.parseInt(sa1[2]));			list.add(d);		}		Collections.sort(list, new Comparator<Details>() { 			public int compare(Details d1, Details d2) {				if(!d1.team.equals(d2.team))					return d1.team.compareTo(d2.team);				else				{					if(d1.mark.equals(d2.mark))						return d1.name.compareTo(d2.name);					return d2.mark.compareTo(d1.mark);				}			}					});//		System.out.println(list);		int cnt = 1;		for(int i=0;i<list.size() && cnt<=m;i++)		{			Details d1 = list.get(i);			if(d1.team.equals(cnt))			{				String s1 = d1.name;				String ans = "";				Details d2 = list.get(i+1);				Details d3 = null;				if(i+2!=n)					d3 = list.get(i+2);				if(d3!=null && d2.team.equals(d3.team) && d2.mark.equals(d3.mark ))				{					ans += "?";				}				else				{					ans+=s1 + " "+d2.name;				}				System.out.println(ans);				cnt++;			}			}		}}class Details {	Integer team;	Integer mark;	String name;		public Details(String name,Integer team, Integer mark) {		super();		this.team = team;		this.mark = mark;		this.name = name;	} 	@Override	public String toString() {		return "["+ team + "," + mark + ", " + name + "]";	}	}
