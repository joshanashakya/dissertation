# Python program to print prime factors import math for _ in range(int(input())):    n=int(input())    arr=list(map(int,input().split()))    ans=[0]*(n)     for i in range(1,n-1):        if arr[i-1]<arr[i]>arr[i+1] or arr[i-1]>arr[i]<arr[i+1]:            ans[i]=1    ss=[]    if n<3:        print(0)    else:        for i in range(1,n-1):            k=0            l=0            f=arr[i]            arr[i]=arr[i-1]            for j in range(i-1,i+2):                if j>0 and j<n-1:                    if arr[j - 1] < arr[j] > arr[j + 1] or arr[j - 1] > arr[j] < arr[j + 1]:                        if ans[j]==0:                            k+=1                    else:                        if ans[j]==1:                            k-=1            arr[i]=arr[i+1]            for j in range(i-1,i+2):                if j>0 and j<n-1:                    if arr[j - 1] < arr[j] > arr[j + 1] or arr[j - 1] > arr[j] < arr[j + 1]:                        if ans[j]==0:                            l+=1                    else:                        if ans[j]==1:                            l-=1            arr[i]=f            # print(k,l,ans)            ss.append(min(k,l))        # print(ss)        print(sum(ans)+min(ss))     
