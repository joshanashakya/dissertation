def do():    import math    n,x,y,d = map(int, input().split())    x-=1    y-=1    n-=1    res = 10 ** 18    if x==y:        print(0)        return    if (y-x) % d == 0:        print(abs((y-x)) // d)        return     cnt = 0    cnt = math.ceil(x / d)    if y % d == 0:        cnt += abs(y // d)        res = min(res, cnt)     cnt = 0    cnt = math.ceil((n-x) / d)    if (n-y) % d == 0:        cnt += abs((n-y) // d)        res = min(res, cnt)     if res == 10**18:        print(-1)        return    else:        print(res)        return qq = int(input())for _ in range(qq):    do()
