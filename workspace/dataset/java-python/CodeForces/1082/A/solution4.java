//No sorceries shall prevail.import java.util.*;import java.io.*;public class Main { 	static Scanner inp= new Scanner(System.in);	static PrintWriter out= new PrintWriter(System.out);	public static void main(String args[]) {		    		   	Main g=new Main();	   	g.main();	   	out.close();	} 			//Main	void main() {				int t=inp.nextInt();		while(t-->0) {			long n=inp.nextLong();			long x=inp.nextLong();			long y=inp.nextLong();			long d=inp.nextLong();			long diff=Math.abs(x-y);			if(diff%d==0) {				System.out.println(diff/d);			}else  {				long x2=(y-1)%d!=0?-1:(y-1)/d;				long y2=(n-y)%d!=0?-1:(n-y)/d;				long gg=Long.MAX_VALUE;				if(x2==-1 && y2==-1) {					System.out.println(-1);					continue;				}				if(x2!=-1) {					gg=x2+(x-1+d-1)/d;				}				if(y2!=-1) {					gg=Math.min(gg, y2+(n-x+d-1)/d);				}				System.out.println(gg);			}			}			}				}
