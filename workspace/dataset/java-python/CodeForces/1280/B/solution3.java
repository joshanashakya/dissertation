import java.io.*;import java.util.*;public class Main {    public static void main(String args[])    {        FastReader input=new FastReader();        PrintWriter out=new PrintWriter(System.out);        int T=input.nextInt();        while(T-->0)        {            int r=input.nextInt();            int c=input.nextInt();            char ch[][]=new char[r][c];            int count=0;            for(int i=0;i<r;i++)            {                String s=input.next();                ch[i]=s.toCharArray();                for(int j=0;j<c;j++)                {                    if(ch[i][j]=='A')                    {                        count++;                    }                }            }            if(count==0)            {                out.println("MORTAL");            }            else if(count==r*c)            {                out.println(0);            }            else            {                int co=0;                int flag=0;                for(int i=0;i<c;i++)                {                    if(ch[0][i]!='A')                    {                        flag=1;                    }                    else                    {                        co++;                    }                }                if(flag==0)                {                    out.println(1);                }                else                {                    flag=0;                    for(int i=0;i<c;i++)                    {                        if(ch[r-1][i]!='A')                        {                            flag=1;                        }                        else                        {                            co++;                        }                    }                    if(flag==0)                    {                        out.println(1);                    }                    else                    {                        flag=0;                        for(int i=0;i<r;i++)                        {                            if(ch[i][0]!='A')                            {                                flag=1;                            }                            else                            {                                co++;                            }                        }                        if(flag==0)                        {                            out.println(1);                        }                        else                        {                            flag=0;                            for(int i=0;i<r;i++)                            {                                if(ch[i][c-1]!='A')                                {                                    flag=1;                                }                                else                                {                                    co++;                                }                            }                            if(flag==0)                            {                                out.println(1);                            }                            else                            {                                if(ch[0][0]=='A' || ch[0][c-1]=='A' || ch[r-1][0]=='A' || ch[r-1][c-1]=='A')                                {                                    out.println(2);                                }                                else                                {                                    flag=0;                                    for(int i=1;i<r-1;i++)                                    {                                        int f=0;                                        for(int j=0;j<c;j++)                                        {                                            if(ch[i][j]!='A')                                            {                                                f=1;                                                break;                                            }                                        }                                        if(f==0)                                        {                                            flag=1;                                            break;                                        }                                    }                                    if(flag==1)                                    {                                        out.println(2);                                    }                                    else                                    {                                        for(int i=1;i<c-1;i++)                                        {                                            int f=0;                                            for(int j=0;j<r;j++)                                            {                                                if(ch[j][i]!='A')                                                {                                                    f=1;                                                    break;                                                }                                            }                                            if(f==0)                                            {                                                flag=1;                                                break;                                            }                                        }                                        if(flag==1)                                        {                                            out.println(2);                                        }                                        else                                        {                                            if(co>0)                                            {                                                out.println(3);                                            }                                            else                                            {                                                out.println(4);                                            }                                        }                                    }                                }                            }                        }                    }                }            }        }        out.close();    }    static class FastReader    {        BufferedReader br;        StringTokenizer st;         public FastReader()        {            br = new BufferedReader(new                    InputStreamReader(System.in));        }         String next()        {            while (st == null || !st.hasMoreElements())            {                try                {                    st = new StringTokenizer(br.readLine());                }                catch (IOException e)                {                    e.printStackTrace();                }            }            return st.nextToken();        }         int nextInt()        {            return Integer.parseInt(next());        }         long nextLong()        {             return Long.parseLong(next());        }         double nextDouble()        {             return Double.parseDouble(next());        }         String nextLine()        {            String str = "";            try            {                str = br.readLine();            }            catch (IOException e)            {                e.printStackTrace();            }            return str;        }    }}
