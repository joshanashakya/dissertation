#include<bits/stdc++.h>using namespace std;#define ll long long#define F first#define S second const ll mod = 1e9 + 7;string s, ens;ll t, x, l;ll sz = 0;const int N=2e5+100; void en (){    ens = s;    int i=0, sizee=ens.size();    string sr="";    while(sizee<x && sizee!=i)    {        if(ens[i]=='1') { i++; continue;}        sr = ens.substr(i+1);        if(ens[i]=='2') ens += sr;        else if (ens[i]=='3') ens += sr+sr;        i++; sizee=ens.size();    }} int main(){    ios::sync_with_stdio(0);    cin.tie(0); cout.tie(0);//    freopen("r.txt", "r", stdin);     cin>>t;    while(t--)    {        cin>>x>>s;        sz = s.size();        en();        l=0;        while(l<x)        {            if(l == ens.size()) break;            int pos = ens[l]-'0';            l++;//            sz = l + pos*sz - pos*l            sz = (l + (pos * (sz-l)));            sz = ( (sz%mod)+mod)%mod;        }        cout<<sz<<"\n";    }    return 0;} //        cout<<ens<<"\n";//            cout<<sz<<"\n";//            cout<<l<<" "<<pos<<" "<<sz<<"\n";//        sz%=mod; /*133321333 33321333 332133333321333332133333321333332133333321333133321333 33321333 332133333321333332133333321333332133333321333*/
