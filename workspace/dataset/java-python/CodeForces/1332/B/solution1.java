import java.util.*; public class _1332B {    public static void main(String[] args) {        Scanner sc = new Scanner(System.in);        int t = sc.nextInt();        while (t-- > 0) {            int n = sc.nextInt();            int[] arr = new int[n];            int[] brr = new int[1001];            Vector<Integer> v = new Vector<>();            for (int i = 0; i < n; i++) {                arr[i] = sc.nextInt();                v.add(arr[i]);            }             for (int i = 0; i < n; i++)                brr[arr[i]] = -1;             int c = 1, done = 0;        for(int i=2;i<=1000;i++) {            for (int j = i*i; j <= 1000; j += i) {                if (brr[j] == -1) {                    brr[j] = c;                    done = 1;                }            }            if (done == 1) {                done = 0;                c++;            }        }            done=0;            for (int i = 0; i < n; i++) {                if (brr[arr[i]] == -1) {                    brr[i] = c;                    done = 1;                }                if (done == 1) {                    done = 0;                    c++;                }            }            HashSet<Integer> set = new HashSet<>();            for (int i = 0; i < n; i++) {                if(brr[arr[i]]!=-1)                    set.add(brr[arr[i]]);            }            System.out.println(set.size());            for (int i = 0; i < n; i++) {                if (brr[arr[i]] != -1 )                    System.out.print(brr[arr[i]]+ " ");            }            System.out.println();        }    }}
