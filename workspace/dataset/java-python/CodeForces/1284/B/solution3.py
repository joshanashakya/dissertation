from os import path;import sys,timemod = int(1e9 + 7)from math import ceil, floor,gcd,log,log2 ,factorial,sqrtfrom collections import defaultdict ,Counter , OrderedDict , deque;from itertools import combinations,permutations# from string import ascii_lowercase ,ascii_uppercasefrom bisect import *;from functools import reduce;from operator import mul;maxx = float('inf')I = lambda :int(sys.stdin.buffer.readline())lint = lambda :[int(x) for x in sys.stdin.buffer.readline().split()]S = lambda: sys.stdin.readline().strip('\n')grid = lambda  r :[lint() for i in range(r)]localsys = 0start_time = time.time()#left shift --- num*(2**k) --(k - shift)nCr = lambda n, r: reduce(mul, range(n - r + 1, n + 1), 1) // factorial(r)def ceill(n,x):    return (n+x -1 )//xT =0def ok(A):	N = A[0]	for i in range(1,A[0]):		if A[i+1] > A[i]:			return (int(1e6)+1 , -1)	return (A[1] , A[-1])def solve():	n = I()	arr = [lint() for _ in range(n)]	X , Y , ans = [0]*int(1e6+2) , [] , 0	for i in range(n):		a ,b = ok(arr[i])		X[a] +=1		Y.append(b)	for i in range(1000000 ,-1, -1):		X[i]+=X[i+1]	for i in Y:		ans+=X[i+1]	print(ans)		           		       def run():    if (path.exists('input.txt')):        sys.stdin=open('input.txt','r')        sys.stdout=open('output.txt','w')  run()T = I() if T else 1for _ in range(T):    solve()  if localsys:    print("\n\nTime Elased :",time.time() - start_time,"seconds")  
